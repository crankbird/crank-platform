# üèóÔ∏è Auto-generated by Container-First Build System
# Environment: --service
# Generated from service build manifests

services:
  crank-cert-authority---s:
    build:
      context: .
      dockerfile: services/Dockerfile.crank-cert-authority
    container_name: crank-cert-authority---s
    environment: []
    ports:
    - ${CRANK_CERT_AUTHORITY_HTTPS_PORT:-9090}:9090
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - -k
      - https://localhost:9090/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 15s
    restart: unless-stopped
    networks:
    - crank-local-net
  crank-email-parser---s:
    build:
      context: .
      dockerfile: services/Dockerfile.crank-email-parser
    container_name: crank-email-parser---s
    environment:
    - PLATFORM_URL=https://crank-platform-dev:8443
    - PLATFORM_AUTH_TOKEN=${PLATFORM_AUTH_TOKEN:-local-dev-key}
    ports:
    - ${CRANK_EMAIL_PARSER_HTTPS_PORT:-8300}:8300
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - -k
      - https://localhost:8300/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 15s
    depends_on:
      crank-platform---s:
        condition: service_healthy
    restart: unless-stopped
    networks:
    - crank-local-net
  crank-platform---s:
    build:
      context: .
      dockerfile: services/Dockerfile.crank-platform
    container_name: crank-platform---s
    environment:
    - PLATFORM_URL=https://crank-platform-dev:8443
    - PLATFORM_AUTH_TOKEN=${PLATFORM_AUTH_TOKEN:-local-dev-key}
    ports:
    - ${CRANK_PLATFORM_HTTPS_PORT:-8443}:8443
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - -k
      - https://localhost:8443/health/live
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 15s
    depends_on:
      crank-cert-authority---s:
        condition: service_healthy
    restart: unless-stopped
    networks:
    - crank-local-net
  crank-streaming---s:
    build:
      context: .
      dockerfile: services/Dockerfile.crank-streaming
    container_name: crank-streaming---s
    environment:
    - PLATFORM_URL=https://crank-platform-dev:8443
    - PLATFORM_AUTH_TOKEN=${PLATFORM_AUTH_TOKEN:-local-dev-key}
    ports:
    - ${CRANK_STREAMING_HTTPS_PORT:-8500}:8500
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - -k
      - https://localhost:8500/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 15s
    depends_on:
      crank-platform---s:
        condition: service_healthy
      crank-email-classifier---s:
        condition: service_healthy
    restart: unless-stopped
    networks:
    - crank-local-net
  crank-email-classifier---s:
    build:
      context: .
      dockerfile: services/Dockerfile.crank-email-classifier
    container_name: crank-email-classifier---s
    environment:
    - PLATFORM_URL=https://crank-platform-dev:8443
    - PLATFORM_AUTH_TOKEN=${PLATFORM_AUTH_TOKEN:-local-dev-key}
    ports:
    - ${CRANK_EMAIL_CLASSIFIER_HTTPS_PORT:-8200}:8200
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - -k
      - https://localhost:8200/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 15s
    depends_on:
      crank-platform---s:
        condition: service_healthy
    restart: unless-stopped
    networks:
    - crank-local-net
  crank-doc-converter---s:
    build:
      context: .
      dockerfile: services/Dockerfile.crank-doc-converter
    container_name: crank-doc-converter---s
    environment:
    - PLATFORM_URL=https://crank-platform-dev:8443
    - PLATFORM_AUTH_TOKEN=${PLATFORM_AUTH_TOKEN:-local-dev-key}
    ports:
    - ${CRANK_DOC_CONVERTER_HTTPS_PORT:-8100}:8100
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - -k
      - https://localhost:8100/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 15s
    depends_on:
      crank-platform---s:
        condition: service_healthy
    restart: unless-stopped
    networks:
    - crank-local-net
  crank-image-classifier---s:
    build:
      context: .
      dockerfile: services/Dockerfile.crank-image-classifier-gpu
    container_name: crank-image-classifier---s
    environment:
    - PLATFORM_URL=https://crank-platform-dev:8443
    - PLATFORM_AUTH_TOKEN=${PLATFORM_AUTH_TOKEN:-local-dev-key}
    ports:
    - ${CRANK_IMAGE_CLASSIFIER_HTTPS_PORT:-8400}:8400
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - -k
      - https://localhost:8400/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 15s
    depends_on:
      crank-platform---s:
        condition: service_healthy
    deploy:
      resources:
        reservations:
          devices:
          - driver: nvidia
            count: all
            capabilities:
            - gpu
    restart: unless-stopped
    networks:
    - crank-local-net
networks:
  crank-local-net:
    driver: bridge
    name: crank-local-network
volumes:
  local-data:
    name: crank-local-data
  local-logs:
    name: crank-local-logs
